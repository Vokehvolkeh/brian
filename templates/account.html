<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finance Dashboard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #e0e7ff, #f4f4f4);
        padding-bottom: 100px;
        color: #1e293b;
      }

      /* Sidebar Styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(180deg, #3b82f6, #2563eb);
        color: white;
        padding: 20px;
        transition: transform 0.3s ease;
        overflow-y: auto;
        z-index: 1000;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      }

      .sidebar.hidden {
        transform: translateX(-100%);
      }

      .sidebar.visible {
        transform: translateX(0);
      }

      .sidebar h1 {
        text-align: center;
        font-size: 26px;
        font-weight: 600;
        margin-bottom: 30px;
        color: #fff;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .sidebar a {
        display: block;
        padding: 15px;
        color: white;
        text-decoration: none;
        margin: 10px 0;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: 400;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .sidebar a:hover {
        background: #ffffff;
        color: #2563eb;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      }

      /* Content Styles */
      .content {
        margin-left: 280px;
        padding: 30px;
        transition: margin-left 0.3s ease;
        background: #ffffff;
        min-height: 100vh;
        border-radius: 0 12px 12px 0;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      }

      /* Menu Toggle Button */
      .menu-toggle {
        display: none;
        background-color: #2563eb;
        color: white;
        border: none;
        padding: 12px 16px;
        font-size: 22px;
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 1001;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .menu-toggle:hover {
        background-color: #1e40af;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          width: 260px;
        }

        .sidebar.visible {
          transform: translateX(0);
        }

        .content {
          margin-left: 0;
          border-radius: 12px;
        }

        .menu-toggle {
          display: block;
        }
      }

      .label {
        font-size: 30px;
        font-weight: 600;
        margin: 40px 0 20px;
        color: #1e40af;
        text-transform: uppercase;
        text-align: center;
        letter-spacing: 1px;
      }

      .table-wrapper,
      .table-wrapper-2 {
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        padding: 25px;
        margin: 20px 0;
        overflow-x: auto;
      }

      .table-modern {
        width: 100%;
        border-collapse: collapse;
        font-size: 15px;
      }

      .table-modern thead {
        background: #2563eb;
        color: #fff;
      }

      .table-modern th,
      .table-modern td {
        padding: 15px 20px;
        text-align: center;
      }

      .table-modern tbody tr:nth-child(even) {
        background: #f8fafc;
      }

      .table-modern tbody tr:hover {
        background: #e0f2fe;
        transition: background 0.3s;
      }

      .profit-cell {
        color: #16a34a;
        font-weight: 600;
      }

      .loss-cell {
        color: #dc2626;
        font-weight: 600;
      }

      .tag-danger {
        background: #dc2626;
        color: white;
        font-weight: 600;
        padding: 6px 12px;
        border-radius: 8px;
      }

      .th {
        background-color: #1e293b;
        color: white;
        font-weight: 500;
      }

      td:hover {
        background-color: #f1f5f9;
        color: #1e293b;
      }

      .topbar {
        height: 70px;
        background: linear-gradient(90deg, #2563eb, #3b82f6);
        color: white;
        display: flex;
        align-items: center;
        padding: 0 30px;
        font-size: 20px;
        font-weight: 500;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      /* Expense Table Specific Styles */
      .table-wrapper h2 {
        text-align: center;
        font-size: 24px;
        color: #1e40af;
        margin-bottom: 20px;
      }

      /* Action Links */
      .table-modern a {
        color: #2563eb;
        text-decoration: none;
        font-weight: 500;
      }

      .table-modern a:hover {
        color: #1e40af;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>

    <div class="sidebar hidden" id="sidebar">
      <h1>üìä Finance Hub</h1>
      <a href="{{ url_for('accounting') }}">üìö Ledger & Records</a>
      <a href="{{ url_for('daily_income_expenses') }}">üí∞ Daily Inflow</a>
      <a href="#">Filter Sales</a>
      <a href="{{ url_for('profit_loss') }}">üìà Profit Tracker</a>
      <a href="{{ url_for('create_expense') }}">‚ûï New Expense</a>
      <a href="{{ url_for('view_expense') }}">üìã Expense History</a>
      <a href="#">Filter Expense</a>
      <a href="{{ url_for('cashflow_statements') }}">üîÑ Cashflow Insights</a>
      <a href="{{ url_for('view_cashflow') }}">üëÅÔ∏è Cashflow Overview</a>
      <a href="#">Filter Cashflow</a>
      <a href="{{ url_for('generate_financial_report') }}"
        >üìë Financial Snapshot</a
      >
      <a href="/dashboard">üè† Home</a>
    </div>

    <div class="content" id="content">
      <div class="topbar">Finance Dashboard</div>

      <h2 class="label">Daily Income and Expenses</h2>
      <div class="table-wrapper">
        <table class="table-modern">
          <thead>
            <tr>
              <th>DATE</th>
              <th>QUANTITY OF GOODS SOLD</th>
              <th>TOTAL INCOME SALES</th>
              <th>EXPENSES</th>
            </tr>
          </thead>
          <tbody>
            {% for sale in daily_data %}
            <tr>
              <td>{{ sale[0] }}</td>
              <td>{{ sale[3] }}</td>
              <td>{{ sale[1] }}</td>
              <td>{{ sale[2] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <h2 class="label">Profit and Loss</h2>
      <div class="table-wrapper">
        <table class="table-modern">
          <thead>
            <tr>
              <th>DATE</th>
              <th>PROFIT</th>
              <th>LOSS</th>
            </tr>
          </thead>
          <tbody>
            {% for sale in profit_loss %}
            <tr>
              <td>{{ sale[0] }}</td>
              <td class="profit-cell">{{ sale[1] }}</td>
              <td class="loss-cell">{{ sale[2] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <h2 class="label">Recorded Operational Expenses</h2>
      {% for date, daily_expenses in grouped_expenses.items() %}
      <div class="table-wrapper">
        <h2>üìÖ Expenses for {{ date }}</h2>
        <table class="table-modern">
          <thead>
            <tr>
              <th>Salaries</th>
              <th>Cost of Goods</th>
              <th>Utilities</th>
              <th>Rent</th>
              <th>Supplies</th>
              <th>Ads</th>
              <th>Insurance</th>
              <th>Maintenance</th>
              <th>Transport</th>
              <th>Taxes</th>
              <th>Total Expenses</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for expense in daily_expenses %}
            <tr>
              <td class="th">{{ expense['salaries'] }}</td>
              <td class="th">{{ expense['cost_of_good'] }}</td>
              <td class="th">
                {{ (expense['internet'] or 0) + (expense['water'] or 0) +
                (expense['electricity'] or 0) }}
              </td>
              <td class="th">{{ expense['rent'] }}</td>
              <td class="th">{{ expense['supplies'] }}</td>
              <td class="th">{{ expense['ads'] }}</td>
              <td class="th">{{ expense['insuarance'] }}</td>
              <td class="th">{{ expense['maintanance'] }}</td>
              <td class="th">{{ expense['transport'] }}</td>
              <td class="th">{{ expense['taxes'] }}</td>
              <td class="th" style="font-weight: bold">
                {{ expense['total_expenses'] }}
              </td>
              <td class="th">
                <a href="{{ url_for('edit_expense', id=expense['id']) }}"
                  >‚úèÔ∏è Edit</a
                >
                |
                <a href="{{ url_for('delete_expense', id=expense['id']) }}"
                  >üóëÔ∏è Delete</a
                >
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endfor %}

      <h2 class="label">All Cashflow Reports</h2>
      {% for report in reports %}
      <div class="table-wrapper-2">
        <p><strong>Cashflow ID:</strong> {{ report['id'] }}</p>
        <p><strong>Start Date:</strong> {{ report['start_date'] }}</p>
        <p><strong>End Date:</strong> {{ report['end_date'] }}</p>
        <table class="table-modern">
          <thead>
            <tr>
              <th>Inflow</th>
              <th>Outflow</th>
              <th>Expenses</th>
              <th>Investments</th>
              <th>Financial</th>
              <th>Total Outflow</th>
              <th>Net Cashflow</th>
              <th>Notes</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="th">{{ report['inflow'] }}</td>
              <td class="th">{{ report['outflow'] }}</td>
              <td class="th">{{ report['expenses'] }}</td>
              <td class="th">{{ report['investments'] }}</td>
              <td class="th">{{ report['financial'] }}</td>
              <td class="th">{{ report['total_outflow'] }}</td>
              <td class="th">{{ report['net_cashflow'] }}</td>
              <td class="th">{{ report['notes'] }}</td>
              <td class="th">
                <a href="{{ url_for('edit_cashflow', id=report['id']) }}"
                  >‚úèÔ∏è Edit</a
                >
                |
                <a
                  href="{{ url_for('delete_cashflow', id=report['id']) }}"
                  onclick="return confirm('Are you sure you want to delete this report?')"
                  >üóëÔ∏è Delete</a
                >
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      {% endfor %}
    </div>

    <script>
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("hidden");
        sidebar.classList.toggle("visible");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const sidebar = document.getElementById("sidebar");
        if (window.innerWidth > 768) {
          sidebar.classList.remove("hidden");
          sidebar.classList.add("visible");
        }
      });
    </script>
  </body>
</html>
